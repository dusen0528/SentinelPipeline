<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>SentinelPipeline Admin Dashboard</title>
  <link rel="stylesheet" href="/admin/static/dashboard/style.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gridstack@9.1.1/dist/gridstack.min.css" />
  <script src="https://cdn.jsdelivr.net/npm/gridstack@9.1.1/dist/gridstack-all.js"></script>
</head>
<body>
  <div class="page">
    <div class="header top-bar">
      <div class="heading">
        <p class="eyebrow">SentinelPipeline</p>
        <h1>Admin Dashboard</h1>
        <small class="auth-hint">인증: ADMIN_WS_API_KEY 설정 시 token 쿼리로 전달. Basic Auth 사용 시 브라우저 팝업 입력. 미설정 시 무인증.</small>
      </div>
      <div class="controls">
        <label class="field">
          <span>WebSocket URL</span>
          <input id="wsUrl" type="text" placeholder="ws://localhost:8000/ws/admin" />
        </label>
        <label class="field">
          <span>Token</span>
          <input id="token" type="text" placeholder="API Key (token 쿼리)" />
        </label>
        <div class="actions">
          <button onclick="connect()">Connect</button>
          <span id="status" class="status-pill disconnected">Disconnected</span>
        </div>
      </div>
    </div>

    <div class="grid-stack">
      <div class="grid-stack-item" data-gs-id="streams" gs-x="0" gs-y="0" gs-w="6" gs-h="4">
        <div class="grid-stack-item-content card">
          <h2>Streams</h2>
          <div class="table-wrap">
            <table id="streams">
              <thead><tr><th>ID</th><th>Status</th><th>FPS</th><th>Errors</th><th>Last Frame TS</th></tr></thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
      </div>

      <div class="grid-stack-item" data-gs-id="modules" gs-x="6" gs-y="0" gs-w="6" gs-h="4">
        <div class="grid-stack-item-content card">
          <h2>Modules</h2>
          <div class="table-wrap">
            <table id="modules">
              <thead><tr><th>Name</th><th>Success</th><th>Errors</th><th>Timeouts</th></tr></thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
      </div>

      <div class="grid-stack-item" data-gs-id="events" gs-x="0" gs-y="4" gs-w="6" gs-h="4">
        <div class="grid-stack-item-content card">
          <h2>Recent Events</h2>
          <div class="table-wrap events-wrap">
            <ul id="events"></ul>
          </div>
        </div>
      </div>

      <div class="grid-stack-item" data-gs-id="streamChart" gs-x="6" gs-y="4" gs-w="6" gs-h="5">
        <div class="grid-stack-item-content card">
          <h2>Stream FPS</h2>
          <div class="chart-container">
            <canvas id="streamChart"></canvas>
          </div>
        </div>
      </div>

      <div class="grid-stack-item" data-gs-id="moduleChart" gs-x="6" gs-y="9" gs-w="6" gs-h="5">
        <div class="grid-stack-item-content card">
          <h2>Modules Throughput/Errors</h2>
          <div class="chart-container">
            <canvas id="moduleChart"></canvas>
          </div>
        </div>
      </div>
    </div>

    <script src="/admin/static/dashboard/app.js"></script>
  </div>
</body>
</html>

